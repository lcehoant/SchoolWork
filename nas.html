<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>SchoolWork NAS</title>
</head>
<body>
  <h2>SchoolWork NAS</h2>
  <button onclick="logout()">Déconnexion</button>

  <table border="1" id="fileGrid">
    <tr><th>Nom</th><th>Taille</th></tr>
    <tr data-size="1.2 Mo"><td><a href="maths/Chapitre_1_Algebre.pdf">Chapitre_1_Algebre.pdf</a></td><td>1.2 Mo</td></tr>
    <tr data-size="320 Ko"><td><a href="maths/Formulaire_2025.docx">Formulaire_2025.docx</a></td><td>320 Ko</td></tr>
    <tr data-size="780 Ko"><td><a href="physique/TP_Electricite.pdf">TP_Electricite.pdf</a></td><td>780 Ko</td></tr>
    <tr data-size="2.4 Mo"><td><a href="physique/Schema_moteur.png">Schema_moteur.png</a></td><td>2.4 Mo</td></tr>
    <tr data-size="420 Ko"><td><a href="francais/Dissertation_Montaigne.docx">Dissertation_Montaigne.docx</a></td><td>420 Ko</td></tr>
    <tr data-size="1.9 Mo"><td><a href="histoire/Civilisations_Antiques.pdf">Civilisations_Antiques.pdf</a></td><td>1.9 Mo</td></tr>
  </table>

  <div style="margin-top:20px">
    <div style="width:300px; background:#ddd; border-radius:10px; overflow:hidden">
      <div id="storageBar" style="height:20px; background:#2d89ef; width:0%"></div>
    </div>
    <p id="storageText"></p>
  </div>

  <script>
    function logout(){
      localStorage.removeItem("sw_logged_in");
      window.location.href="login.html";
    }

    function parseSizeToMo(str){
      str=str.toLowerCase();
      let num=parseFloat(str.replace(',','.'));
      if(str.includes('ko')) return num/1000;
      return num;
    }

    function updateStorage(){
      const rows=document.querySelectorAll('#fileGrid tr[data-size]');
      let used=0;
      rows.forEach(r=>{ used+=parseSizeToMo(r.dataset.size); });
      const total=1000; // 1 Go
      const pct=Math.min(100,(used/total)*100);
      storageBar.style.width=pct+"%";
      storageText.textContent=`${used.toFixed(1)} Mo utilisés sur 1 Go`;
    }
    updateStorage();
  </script>
</body>
</html>
